// Build input boxes for pattern filter
function createPatternBoxes(len) {
  const box = document.getElementById("pattern-boxes");
  box.innerHTML = '';
  for (let i = 0; i < len; i++) {
    const input = document.createElement("input");
    input.type = "text";
    input.maxLength = 1;
    input.size = 1;
    input.dataset.index = i;
    input.placeholder = i + 1;
    input.style.marginRight = '5px';
    box.appendChild(input);
  }
}

// Auto-generate boxes when rack is typed
document.querySelector("input[name='rack']").addEventListener("input", e => {
  const rack = e.target.value.trim().toUpperCase();
  createPatternBoxes(Math.min(rack.length, 7));
});

// Apply letter pattern filtering
document.getElementById("apply-pattern").addEventListener("click", () => {
  const inputs = [...document.querySelectorAll("#pattern-boxes input")];
  const pattern = inputs.map(i => i.value.trim().toUpperCase() || ".").join("");
  if (!pattern) return;

  const spans = document.querySelectorAll(".word");
  spans.forEach(span => {
    const w = span.textContent.trim().toUpperCase();
    span.style.display = (new RegExp("^" + pattern + "$")).test(w) ? "inline" : "none";
  });
});

// Reset word visibility
document.getElementById("reset-pattern").addEventListener("click", () => {
  document.querySelectorAll(".word").forEach(span => {
    span.style.display = "inline";
  });
});